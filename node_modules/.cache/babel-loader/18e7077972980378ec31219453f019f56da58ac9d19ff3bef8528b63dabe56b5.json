{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst Generator = require(\"../Generator\");\nconst WebAssemblyExportImportedDependency = require(\"../dependencies/WebAssemblyExportImportedDependency\");\nconst WebAssemblyImportDependency = require(\"../dependencies/WebAssemblyImportDependency\");\nconst {\n  compareModulesByIdentifier\n} = require(\"../util/comparators\");\nconst memoize = require(\"../util/memoize\");\nconst WebAssemblyInInitialChunkError = require(\"./WebAssemblyInInitialChunkError\");\n\n/** @typedef {import(\"webpack-sources\").Source} Source */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../Module\")} Module */\n/** @typedef {import(\"../ModuleTemplate\")} ModuleTemplate */\n/** @typedef {import(\"../javascript/JavascriptModulesPlugin\").RenderContext} RenderContext */\n\nconst getWebAssemblyGenerator = memoize(() => require(\"./WebAssemblyGenerator\"));\nconst getWebAssemblyJavascriptGenerator = memoize(() => require(\"./WebAssemblyJavascriptGenerator\"));\nconst getWebAssemblyParser = memoize(() => require(\"./WebAssemblyParser\"));\nclass WebAssemblyModulesPlugin {\n  constructor(options) {\n    this.options = options;\n  }\n\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n  apply(compiler) {\n    compiler.hooks.compilation.tap(\"WebAssemblyModulesPlugin\", (compilation, _ref) => {\n      let {\n        normalModuleFactory\n      } = _ref;\n      compilation.dependencyFactories.set(WebAssemblyImportDependency, normalModuleFactory);\n      compilation.dependencyFactories.set(WebAssemblyExportImportedDependency, normalModuleFactory);\n      normalModuleFactory.hooks.createParser.for(\"webassembly/sync\").tap(\"WebAssemblyModulesPlugin\", () => {\n        const WebAssemblyParser = getWebAssemblyParser();\n        return new WebAssemblyParser();\n      });\n      normalModuleFactory.hooks.createGenerator.for(\"webassembly/sync\").tap(\"WebAssemblyModulesPlugin\", () => {\n        const WebAssemblyJavascriptGenerator = getWebAssemblyJavascriptGenerator();\n        const WebAssemblyGenerator = getWebAssemblyGenerator();\n        return Generator.byType({\n          javascript: new WebAssemblyJavascriptGenerator(),\n          webassembly: new WebAssemblyGenerator(this.options)\n        });\n      });\n      compilation.hooks.renderManifest.tap(\"WebAssemblyModulesPlugin\", (result, options) => {\n        const {\n          chunkGraph\n        } = compilation;\n        const {\n          chunk,\n          outputOptions,\n          codeGenerationResults\n        } = options;\n        for (const module of chunkGraph.getOrderedChunkModulesIterable(chunk, compareModulesByIdentifier)) {\n          if (module.type === \"webassembly/sync\") {\n            const filenameTemplate = outputOptions.webassemblyModuleFilename;\n            result.push({\n              render: () => codeGenerationResults.getSource(module, chunk.runtime, \"webassembly\"),\n              filenameTemplate,\n              pathOptions: {\n                module,\n                runtime: chunk.runtime,\n                chunkGraph\n              },\n              auxiliary: true,\n              identifier: `webassemblyModule${chunkGraph.getModuleId(module)}`,\n              hash: chunkGraph.getModuleHash(module, chunk.runtime)\n            });\n          }\n        }\n        return result;\n      });\n      compilation.hooks.afterChunks.tap(\"WebAssemblyModulesPlugin\", () => {\n        const chunkGraph = compilation.chunkGraph;\n        const initialWasmModules = new Set();\n        for (const chunk of compilation.chunks) {\n          if (chunk.canBeInitial()) {\n            for (const module of chunkGraph.getChunkModulesIterable(chunk)) {\n              if (module.type === \"webassembly/sync\") {\n                initialWasmModules.add(module);\n              }\n            }\n          }\n        }\n        for (const module of initialWasmModules) {\n          compilation.errors.push(new WebAssemblyInInitialChunkError(module, compilation.moduleGraph, compilation.chunkGraph, compilation.requestShortener));\n        }\n      });\n    });\n  }\n}\nmodule.exports = WebAssemblyModulesPlugin;","map":{"version":3,"names":["Generator","require","WebAssemblyExportImportedDependency","WebAssemblyImportDependency","compareModulesByIdentifier","memoize","WebAssemblyInInitialChunkError","getWebAssemblyGenerator","getWebAssemblyJavascriptGenerator","getWebAssemblyParser","WebAssemblyModulesPlugin","constructor","options","apply","compiler","hooks","compilation","tap","_ref","normalModuleFactory","dependencyFactories","set","createParser","for","WebAssemblyParser","createGenerator","WebAssemblyJavascriptGenerator","WebAssemblyGenerator","byType","javascript","webassembly","renderManifest","result","chunkGraph","chunk","outputOptions","codeGenerationResults","module","getOrderedChunkModulesIterable","type","filenameTemplate","webassemblyModuleFilename","push","render","getSource","runtime","pathOptions","auxiliary","identifier","getModuleId","hash","getModuleHash","afterChunks","initialWasmModules","Set","chunks","canBeInitial","getChunkModulesIterable","add","errors","moduleGraph","requestShortener","exports"],"sources":["/Users/ritasabri/Desktop/PENN/interpretme_v2/node_modules/webpack/lib/wasm-sync/WebAssemblyModulesPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst Generator = require(\"../Generator\");\nconst WebAssemblyExportImportedDependency = require(\"../dependencies/WebAssemblyExportImportedDependency\");\nconst WebAssemblyImportDependency = require(\"../dependencies/WebAssemblyImportDependency\");\nconst { compareModulesByIdentifier } = require(\"../util/comparators\");\nconst memoize = require(\"../util/memoize\");\nconst WebAssemblyInInitialChunkError = require(\"./WebAssemblyInInitialChunkError\");\n\n/** @typedef {import(\"webpack-sources\").Source} Source */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../Module\")} Module */\n/** @typedef {import(\"../ModuleTemplate\")} ModuleTemplate */\n/** @typedef {import(\"../javascript/JavascriptModulesPlugin\").RenderContext} RenderContext */\n\nconst getWebAssemblyGenerator = memoize(() =>\n\trequire(\"./WebAssemblyGenerator\")\n);\nconst getWebAssemblyJavascriptGenerator = memoize(() =>\n\trequire(\"./WebAssemblyJavascriptGenerator\")\n);\nconst getWebAssemblyParser = memoize(() => require(\"./WebAssemblyParser\"));\n\nclass WebAssemblyModulesPlugin {\n\tconstructor(options) {\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\t\"WebAssemblyModulesPlugin\",\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tWebAssemblyImportDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tWebAssemblyExportImportedDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\n\t\t\t\tnormalModuleFactory.hooks.createParser\n\t\t\t\t\t.for(\"webassembly/sync\")\n\t\t\t\t\t.tap(\"WebAssemblyModulesPlugin\", () => {\n\t\t\t\t\t\tconst WebAssemblyParser = getWebAssemblyParser();\n\n\t\t\t\t\t\treturn new WebAssemblyParser();\n\t\t\t\t\t});\n\n\t\t\t\tnormalModuleFactory.hooks.createGenerator\n\t\t\t\t\t.for(\"webassembly/sync\")\n\t\t\t\t\t.tap(\"WebAssemblyModulesPlugin\", () => {\n\t\t\t\t\t\tconst WebAssemblyJavascriptGenerator =\n\t\t\t\t\t\t\tgetWebAssemblyJavascriptGenerator();\n\t\t\t\t\t\tconst WebAssemblyGenerator = getWebAssemblyGenerator();\n\n\t\t\t\t\t\treturn Generator.byType({\n\t\t\t\t\t\t\tjavascript: new WebAssemblyJavascriptGenerator(),\n\t\t\t\t\t\t\twebassembly: new WebAssemblyGenerator(this.options)\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\tcompilation.hooks.renderManifest.tap(\n\t\t\t\t\t\"WebAssemblyModulesPlugin\",\n\t\t\t\t\t(result, options) => {\n\t\t\t\t\t\tconst { chunkGraph } = compilation;\n\t\t\t\t\t\tconst { chunk, outputOptions, codeGenerationResults } = options;\n\n\t\t\t\t\t\tfor (const module of chunkGraph.getOrderedChunkModulesIterable(\n\t\t\t\t\t\t\tchunk,\n\t\t\t\t\t\t\tcompareModulesByIdentifier\n\t\t\t\t\t\t)) {\n\t\t\t\t\t\t\tif (module.type === \"webassembly/sync\") {\n\t\t\t\t\t\t\t\tconst filenameTemplate =\n\t\t\t\t\t\t\t\t\toutputOptions.webassemblyModuleFilename;\n\n\t\t\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\t\t\trender: () =>\n\t\t\t\t\t\t\t\t\t\tcodeGenerationResults.getSource(\n\t\t\t\t\t\t\t\t\t\t\tmodule,\n\t\t\t\t\t\t\t\t\t\t\tchunk.runtime,\n\t\t\t\t\t\t\t\t\t\t\t\"webassembly\"\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tfilenameTemplate,\n\t\t\t\t\t\t\t\t\tpathOptions: {\n\t\t\t\t\t\t\t\t\t\tmodule,\n\t\t\t\t\t\t\t\t\t\truntime: chunk.runtime,\n\t\t\t\t\t\t\t\t\t\tchunkGraph\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tauxiliary: true,\n\t\t\t\t\t\t\t\t\tidentifier: `webassemblyModule${chunkGraph.getModuleId(\n\t\t\t\t\t\t\t\t\t\tmodule\n\t\t\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t\t\t\t\thash: chunkGraph.getModuleHash(module, chunk.runtime)\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tcompilation.hooks.afterChunks.tap(\"WebAssemblyModulesPlugin\", () => {\n\t\t\t\t\tconst chunkGraph = compilation.chunkGraph;\n\t\t\t\t\tconst initialWasmModules = new Set();\n\t\t\t\t\tfor (const chunk of compilation.chunks) {\n\t\t\t\t\t\tif (chunk.canBeInitial()) {\n\t\t\t\t\t\t\tfor (const module of chunkGraph.getChunkModulesIterable(chunk)) {\n\t\t\t\t\t\t\t\tif (module.type === \"webassembly/sync\") {\n\t\t\t\t\t\t\t\t\tinitialWasmModules.add(module);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const module of initialWasmModules) {\n\t\t\t\t\t\tcompilation.errors.push(\n\t\t\t\t\t\t\tnew WebAssemblyInInitialChunkError(\n\t\t\t\t\t\t\t\tmodule,\n\t\t\t\t\t\t\t\tcompilation.moduleGraph,\n\t\t\t\t\t\t\t\tcompilation.chunkGraph,\n\t\t\t\t\t\t\t\tcompilation.requestShortener\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n}\n\nmodule.exports = WebAssemblyModulesPlugin;\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,YAAY;;AAEZ,MAAMA,SAAS,GAAGC,OAAO,CAAC,cAAc,CAAC;AACzC,MAAMC,mCAAmC,GAAGD,OAAO,CAAC,qDAAqD,CAAC;AAC1G,MAAME,2BAA2B,GAAGF,OAAO,CAAC,6CAA6C,CAAC;AAC1F,MAAM;EAAEG;AAA2B,CAAC,GAAGH,OAAO,CAAC,qBAAqB,CAAC;AACrE,MAAMI,OAAO,GAAGJ,OAAO,CAAC,iBAAiB,CAAC;AAC1C,MAAMK,8BAA8B,GAAGL,OAAO,CAAC,kCAAkC,CAAC;;AAElF;AACA;AACA;AACA;AACA;;AAEA,MAAMM,uBAAuB,GAAGF,OAAO,CAAC,MACvCJ,OAAO,CAAC,wBAAwB,CAAC,CACjC;AACD,MAAMO,iCAAiC,GAAGH,OAAO,CAAC,MACjDJ,OAAO,CAAC,kCAAkC,CAAC,CAC3C;AACD,MAAMQ,oBAAoB,GAAGJ,OAAO,CAAC,MAAMJ,OAAO,CAAC,qBAAqB,CAAC,CAAC;AAE1E,MAAMS,wBAAwB,CAAC;EAC9BC,WAAWA,CAACC,OAAO,EAAE;IACpB,IAAI,CAACA,OAAO,GAAGA,OAAO;EACvB;;EAEA;AACD;AACA;AACA;AACA;EACCC,KAAKA,CAACC,QAAQ,EAAE;IACfA,QAAQ,CAACC,KAAK,CAACC,WAAW,CAACC,GAAG,CAC7B,0BAA0B,EAC1B,CAACD,WAAW,EAAAE,IAAA,KAA8B;MAAA,IAA5B;QAAEC;MAAoB,CAAC,GAAAD,IAAA;MACpCF,WAAW,CAACI,mBAAmB,CAACC,GAAG,CAClClB,2BAA2B,EAC3BgB,mBAAmB,CACnB;MAEDH,WAAW,CAACI,mBAAmB,CAACC,GAAG,CAClCnB,mCAAmC,EACnCiB,mBAAmB,CACnB;MAEDA,mBAAmB,CAACJ,KAAK,CAACO,YAAY,CACpCC,GAAG,CAAC,kBAAkB,CAAC,CACvBN,GAAG,CAAC,0BAA0B,EAAE,MAAM;QACtC,MAAMO,iBAAiB,GAAGf,oBAAoB,EAAE;QAEhD,OAAO,IAAIe,iBAAiB,EAAE;MAC/B,CAAC,CAAC;MAEHL,mBAAmB,CAACJ,KAAK,CAACU,eAAe,CACvCF,GAAG,CAAC,kBAAkB,CAAC,CACvBN,GAAG,CAAC,0BAA0B,EAAE,MAAM;QACtC,MAAMS,8BAA8B,GACnClB,iCAAiC,EAAE;QACpC,MAAMmB,oBAAoB,GAAGpB,uBAAuB,EAAE;QAEtD,OAAOP,SAAS,CAAC4B,MAAM,CAAC;UACvBC,UAAU,EAAE,IAAIH,8BAA8B,EAAE;UAChDI,WAAW,EAAE,IAAIH,oBAAoB,CAAC,IAAI,CAACf,OAAO;QACnD,CAAC,CAAC;MACH,CAAC,CAAC;MAEHI,WAAW,CAACD,KAAK,CAACgB,cAAc,CAACd,GAAG,CACnC,0BAA0B,EAC1B,CAACe,MAAM,EAAEpB,OAAO,KAAK;QACpB,MAAM;UAAEqB;QAAW,CAAC,GAAGjB,WAAW;QAClC,MAAM;UAAEkB,KAAK;UAAEC,aAAa;UAAEC;QAAsB,CAAC,GAAGxB,OAAO;QAE/D,KAAK,MAAMyB,MAAM,IAAIJ,UAAU,CAACK,8BAA8B,CAC7DJ,KAAK,EACL9B,0BAA0B,CAC1B,EAAE;UACF,IAAIiC,MAAM,CAACE,IAAI,KAAK,kBAAkB,EAAE;YACvC,MAAMC,gBAAgB,GACrBL,aAAa,CAACM,yBAAyB;YAExCT,MAAM,CAACU,IAAI,CAAC;cACXC,MAAM,EAAEA,CAAA,KACPP,qBAAqB,CAACQ,SAAS,CAC9BP,MAAM,EACNH,KAAK,CAACW,OAAO,EACb,aAAa,CACb;cACFL,gBAAgB;cAChBM,WAAW,EAAE;gBACZT,MAAM;gBACNQ,OAAO,EAAEX,KAAK,CAACW,OAAO;gBACtBZ;cACD,CAAC;cACDc,SAAS,EAAE,IAAI;cACfC,UAAU,EAAG,oBAAmBf,UAAU,CAACgB,WAAW,CACrDZ,MAAM,CACL,EAAC;cACHa,IAAI,EAAEjB,UAAU,CAACkB,aAAa,CAACd,MAAM,EAAEH,KAAK,CAACW,OAAO;YACrD,CAAC,CAAC;UACH;QACD;QAEA,OAAOb,MAAM;MACd,CAAC,CACD;MAEDhB,WAAW,CAACD,KAAK,CAACqC,WAAW,CAACnC,GAAG,CAAC,0BAA0B,EAAE,MAAM;QACnE,MAAMgB,UAAU,GAAGjB,WAAW,CAACiB,UAAU;QACzC,MAAMoB,kBAAkB,GAAG,IAAIC,GAAG,EAAE;QACpC,KAAK,MAAMpB,KAAK,IAAIlB,WAAW,CAACuC,MAAM,EAAE;UACvC,IAAIrB,KAAK,CAACsB,YAAY,EAAE,EAAE;YACzB,KAAK,MAAMnB,MAAM,IAAIJ,UAAU,CAACwB,uBAAuB,CAACvB,KAAK,CAAC,EAAE;cAC/D,IAAIG,MAAM,CAACE,IAAI,KAAK,kBAAkB,EAAE;gBACvCc,kBAAkB,CAACK,GAAG,CAACrB,MAAM,CAAC;cAC/B;YACD;UACD;QACD;QACA,KAAK,MAAMA,MAAM,IAAIgB,kBAAkB,EAAE;UACxCrC,WAAW,CAAC2C,MAAM,CAACjB,IAAI,CACtB,IAAIpC,8BAA8B,CACjC+B,MAAM,EACNrB,WAAW,CAAC4C,WAAW,EACvB5C,WAAW,CAACiB,UAAU,EACtBjB,WAAW,CAAC6C,gBAAgB,CAC5B,CACD;QACF;MACD,CAAC,CAAC;IACH,CAAC,CACD;EACF;AACD;AAEAxB,MAAM,CAACyB,OAAO,GAAGpD,wBAAwB"},"metadata":{},"sourceType":"script","externalDependencies":[]}